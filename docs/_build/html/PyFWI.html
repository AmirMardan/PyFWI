<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PyFWI package &mdash; PyFWI 0.0.3 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PyFWI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PyFWI package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.acquisition">acquisition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.fwi">fwi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.fwi_tools">fwi_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.model_dataset">model_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.optimization">optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.processing">processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.rock_physics">rock_physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.seiplot">seiplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.seismic_io">seismic_io</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI.wave_propagation">wave_propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PyFWI">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyFWI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>PyFWI package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/PyFWI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyfwi-package">
<h1>PyFWI package<a class="headerlink" href="#pyfwi-package" title="Permalink to this headline"></a></h1>
<section id="module-PyFWI.acquisition">
<span id="acquisition"></span><h2>acquisition<a class="headerlink" href="#module-PyFWI.acquisition" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.AcqParameters">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">AcqParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_dis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.AcqParameters" title="Permalink to this definition"></a></dt>
<dd><p>A function to define the acquisition based on user’s demand</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>INPA</strong> (<em>dictionary</em>) – <dl class="simple">
<dt>A dictionnary containing required parameters for iversion, at least:</dt><dd><ul class="simple">
<li><p>ns: Number of sources</p></li>
<li><p>rec_dis: Distance between receivers</p></li>
<li><p>offsetx: Length of acquisition in x-direction</p></li>
<li><p>depth: Depth of acquisition</p></li>
<li><p>dh: spatial sampling rate</p></li>
<li><p>sdo: Spatial differentiation order</p></li>
<li><p>acq_type: Type of acquisition (0: crosswell, 1: surface, 2: both)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>src_loc</strong> (<em>float32</em>) – Location of sources</p></li>
<li><p><strong>rec-loc</strong> (<em>float32</em>) – Location of receivers</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.acquisition.Source">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">Source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.Source" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for defining different types of sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_loc</strong> (<em>float32</em>) – location of sources.</p></li>
<li><p><strong>dh</strong> (<em>float</em>) – Spatial sampling rate.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Temporal sampling rate</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.acquisition.Source.Ricker">
<span class="sig-name descname"><span class="pre">Ricker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fdom</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.Source.Ricker" title="Permalink to this definition"></a></dt>
<dd><p>Amethod to generate Ricker wavelet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fdom</strong> (<em>float32</em>) – Dominant frequency of wavelet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.acquisition.Source.delta">
<span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.Source.delta" title="Permalink to this definition"></a></dt>
<dd><p>A method to generate spike.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fdom</strong> (<em>float32</em>) – Dominant frequency of wavelet</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.SurfaceSeismic">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">SurfaceSeismic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_dis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.SurfaceSeismic" title="Permalink to this definition"></a></dt>
<dd><p>A function to design a surface seismic acquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ns</strong> (<em>int</em>) – Number of sources</p></li>
<li><p><strong>rec_dis</strong> (<em>float32</em>) – Distance between receivers</p></li>
<li><p><strong>offsetx</strong> (<em>flloat32</em>) – Length of survey in x-direction</p></li>
<li><p><strong>offsetz</strong> (<em>float32</em>) – Depth of survey</p></li>
<li><p><strong>dh</strong> (<em>float32</em>) – Spatial sampling rate</p></li>
<li><p><strong>sdo</strong> (<em>{2</em><em>, </em><em>4</em><em>, </em><em>8}</em>) – Spatial order of finite difference method</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>src_loc</strong> (<em>float32</em>) – Location of sources</p></li>
<li><p><strong>rec_loc</strong> (<em>float32</em>) – Location of receivers</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.acquisition_plan">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">acquisition_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_well_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.acquisition_plan" title="Permalink to this definition"></a></dt>
<dd><p>acquisition_plan generates the matrix of acquisition plan</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ns</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>nr</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>src_loc</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rec_loc</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>acq_type</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>n_well_rec</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>dh</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.crosswell">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">crosswell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_dis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.crosswell" title="Permalink to this definition"></a></dt>
<dd><p>A function to design a crosswell acquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ns</strong> (<em>int</em>) – Number of sources</p></li>
<li><p><strong>rec_dis</strong> (<em>float32</em>) – Distance between receivers</p></li>
<li><p><strong>offsetx</strong> (<em>flloat32</em>) – Length of survey in x-direction</p></li>
<li><p><strong>offsetz</strong> (<em>float32</em>) – Depth of survey</p></li>
<li><p><strong>dh</strong> (<em>float32</em>) – Sampling rate</p></li>
<li><p><strong>sdo</strong> (<em>{2</em><em>, </em><em>4</em><em>, </em><em>8}</em>) – Spatial order of finite difference method</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>src_loc</strong> (<em>float32</em>) – Location of sources</p></li>
<li><p><strong>rec_loc</strong> (<em>float32</em>) – Location of receivers</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.discretized_acquisition_plan">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">discretized_acquisition_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_guide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.discretized_acquisition_plan" title="Permalink to this definition"></a></dt>
<dd><p>discretized_acquisition_plan discretizes the matrix of acquisition plan</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_guide</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>dh</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>npml</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.prepare_residual">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">prepare_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.prepare_residual" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.acquisition.seismic_section">
<span class="sig-prename descclassname"><span class="pre">PyFWI.acquisition.</span></span><span class="sig-name descname"><span class="pre">seismic_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seismo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.acquisition.seismic_section" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-PyFWI.fwi">
<span id="fwi"></span><h2>fwi<a class="headerlink" href="#module-PyFWI.fwi" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi.FWI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi.</span></span><span class="sig-name descname"><span class="pre">FWI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_well_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi.FWI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#PyFWI.wave_propagation.wave_propagator" title="PyFWI.wave_propagation.wave_propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.wave_propagation.wave_propagator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi.FWI.fprime">
<span class="sig-name descname"><span class="pre">fprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi.FWI.fprime" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi.FWI.fprime_single">
<span class="sig-name descname"><span class="pre">fprime_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi.FWI.fprime_single" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi.FWI.lbfgs">
<span class="sig-name descname"><span class="pre">lbfgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ITER</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi.FWI.lbfgs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi.FWI.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi.FWI.run" title="Permalink to this definition"></a></dt>
<dd><p>run method performs the FWI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m0</strong> (<em>dict</em>) – The initial model</p></li>
<li><p><strong>method</strong> (<em>int</em><em>, </em><em>str</em>) – The optimization method</p></li>
<li><p><strong>iter</strong> (<em>ndarray</em><em>)</em>) – An array of iteration for each frequency</p></li>
<li><p><strong>freqs</strong> (<em>float</em>) – Frequencies for multi-scale inversion.</p></li>
<li><p><strong>n_params</strong> (<em>int</em>) – Number of parameter to invert for in each time</p></li>
<li><p><strong>k_0</strong> (<em>int</em>) – The first parameter of interest</p></li>
<li><p><strong>k_end</strong> (<em>int</em>) – The last parameter of interest</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>m_est</strong> (<em>dictionary</em>) – The estimated model</p></li>
<li><p><strong>rms</strong> (<em>ndarray</em>) – The rms error</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyFWI.fwi_tools">
<span id="fwi-tools"></span><h2>fwi_tools<a class="headerlink" href="#module-PyFWI.fwi_tools" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CPML">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">CPML</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">62.83185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nalpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CPML" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CPML.pml_prepare">
<span class="sig-name descname"><span class="pre">pml_prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CPML.pml_prepare" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CPML.psi_reset">
<span class="sig-name descname"><span class="pre">psi_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TNz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CPML.psi_reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">CostFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_function_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class provides different cost functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.exponential_cost">
<span class="sig-name descname"><span class="pre">exponential_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.exponential_cost" title="Permalink to this definition"></a></dt>
<dd><p>based on
<a class="reference external" href="https://stats.stackexchange.com/questions/154879/a-list-of-cost-functions-used-in-neural-networks-alongside-applications">https://stats.stackexchange.com/questions/154879/a-list-of-cost-functions-used-in-neural-networks-alongside-applications</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.l1">
<span class="sig-name descname"><span class="pre">l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.l1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.l2">
<span class="sig-name descname"><span class="pre">l2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.l2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.l2_envelope">
<span class="sig-name descname"><span class="pre">l2_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.l2_envelope" title="Permalink to this definition"></a></dt>
<dd><p>based on Wu et al., 2014, Seismic envelope inversion and modulation signal model
Geiophysics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.l2_hilbert">
<span class="sig-name descname"><span class="pre">l2_hilbert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.l2_hilbert" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.l2_intensity">
<span class="sig-name descname"><span class="pre">l2_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.l2_intensity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.list2dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">list2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.list2dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.plot_amp_spectrum">
<span class="sig-name descname"><span class="pre">plot_amp_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_a_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_b_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.plot_amp_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>to compare two amplitude spectrum</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.CostFunction.plot_trace">
<span class="sig-name descname"><span class="pre">plot_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_a_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_b_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.CostFunction.plot_trace" title="Permalink to this definition"></a></dt>
<dd><p>to compare two trace</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.adj_cost_preparation">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">adj_cost_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_oh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.adj_cost_preparation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.adj_lowpass">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">adj_lowpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.adj_lowpass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.cost_function">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">cost_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.cost_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.cost_preparation">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">cost_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_oh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.cost_preparation" title="Permalink to this definition"></a></dt>
<dd><p>cost_preparation prepare the data for calculating the cost function</p>
<p>This function prepare the data for calculating the cost function.
This preparation is based on multi-scale inversion strategy (Bunks et al., 1995).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpre</strong> (<em>[</em><em>type</em><em>]</em>) – Predicted data</p></li>
<li><p><strong>dobs</strong> (<em>[</em><em>type</em><em>]</em>) – Observed data</p></li>
<li><p><strong>fn</strong> (<em>float</em>) – Nyquist frequency</p></li>
<li><p><strong>freq</strong> (<em>float</em><em>, </em><em>optional</em>) – Desire frequency for filtering. Defaults to None.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the filter. Defaults to None.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – Axis of the filter. Defaults to None.</p></li>
<li><p><strong>params_oh</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – Parameter to prepare the data for different offsets. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.cost_seismic">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">cost_seismic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_pre0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_obs0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourc_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_oh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.cost_seismic" title="Permalink to this definition"></a></dt>
<dd><p>cost_seismic calculates the cost between estimated and observed data.</p>
<p>This function calculates the cost between estimated and observed data by applying desired filters
and returns the cost and the adjoint of the residual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_pre0</strong> (<em>dict</em>) – Estimated data</p></li>
<li><p><strong>d_obs0</strong> (<em>dict</em>) – Observed data</p></li>
<li><p><strong>fun</strong> (<em>function</em>) – The function to calculate the cost. This could be “CF = tools.CostFunction(‘l2’)”</p></li>
<li><p><strong>fn</strong> (<em>float</em><em>, </em><em>optional</em>) – Nyquist frequency. Defaults to None.</p></li>
<li><p><strong>freq</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired frequency to implement the lowpass filter. Defaults to None.</p></li>
<li><p><strong>order</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>axis</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>sourc_weight</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>ns</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of the sources. Defaults to None.</p></li>
<li><p><strong>nr</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of the receivers. Defaults to None.</p></li>
<li><p><strong>params_oh</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cost
adj_src: Adjoint source to propagate through the model in adjoint wave equation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rms (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.derivative">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.derivative" title="Permalink to this definition"></a></dt>
<dd><p>Compute spatial derivative operators for grid _cells_
For 1st order:</p>
<blockquote>
<div><p>forward operator is (u_{i+1} - u_i)/dx</p>
<p>centered operator is (u_{i+1} - u_{i-1})/(2dx)</p>
<p>backward operator is (u_i - u_{i-1})/dx</p>
</div></blockquote>
<p>For 2nd order:</p>
<blockquote>
<div><p>forward operator is (u_i - 2u_{i+1} + u_{i+2})/dx^2</p>
<p>centered operator is (u_{i-1} - 2u_i + u_{i+1})/dx^2</p>
<p>backward operator is (u_{i-2} - 2u_{i-1} + u_i)/dx^2</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> (<em>int</em>) – Number of samples in X-direction</p></li>
<li><p><strong>nz</strong> (<em>int</em>) – Number of samples in Z-direction</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Samplikng rate in X-direction</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Samplikng rate in Z-direction</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order of derivative</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Dx</strong> (<em>Dispersed matrix</em>) – Derivative matrix in X-direction</p></li>
<li><p><strong>Dz</strong> (<em>Dispersed matrix</em>) – Derivative matrix in Z-direction</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.dict_diff">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">dict_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.dict_diff" title="Permalink to this definition"></a></dt>
<dd><p>dict_diff subtracts the contents of two dictionaries</p>
<p>This function is used to subtract the parameters of a
dictionary with the same parameter in another dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict1</strong> (<em>dict</em>) – The first dictionary</p></li>
<li><p><strong>dict2</strong> (<em>dict</em>) – The second dictionary</p></li>
<li><p><strong>positivity</strong> (<em>boolean</em><em>, </em><em>optional</em>) – A boolean variable to specify if the used wants</p></li>
<li><p><strong>False.</strong> (<em>to filter out the negative differences. Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the common parameters of <code class="docutils literal notranslate"><span class="pre">`dict1`</span></code> and <code class="docutils literal notranslate"><span class="pre">`dict2`</span></code>, but their difference.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dic</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.dict_summation">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">dict_summation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.dict_summation" title="Permalink to this definition"></a></dt>
<dd><p>dict_summation add the contents of two dictionaries</p>
<p>This function is used to add the parameters of a
dictionary with the same parameter in another dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict1</strong> (<em>dict</em>) – The first dictionary</p></li>
<li><p><strong>dict2</strong> (<em>dict</em>) – The second dictionary</p></li>
<li><p><strong>division</strong> (<em>float</em><em>, </em><em>optional</em>) – In cas if user wants to devide the summation to a number (e.g. averaging)</p></li>
<li><p><strong>1.0.</strong> (<em>of amplifying the result. Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the common parameters of <code class="docutils literal notranslate"><span class="pre">`dict1`</span></code> and <code class="docutils literal notranslate"><span class="pre">`dict2`</span></code>, but their summation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dic</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.expand_model">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">expand_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.expand_model" title="Permalink to this definition"></a></dt>
<dd><p>This function make room around the ‘parameter’ to stick the pml layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter</strong> (<em>float</em>) – Matrix of property that we are going to consider pml around.</p></li>
<li><p><strong>TNz</strong> (<em>int</em>) – Number of samples in z-direction (<cite>n_z + 2 * n_pml</cite>).</p></li>
<li><p><strong>TNx</strong> (<em>int</em>) – Number of samples in x-direction (<cite>n_x + 2 * n_pml</cite>).</p></li>
<li><p><strong>n_pml</strong> (<em>int</em><em>, </em><em>optional = 10</em>) – Number of pml layer</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nu</strong> – A matrix with the size of [TNz, TNx] with zero value
everywhere excpet in center which consisting the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">fdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.c1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c1</span></span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.c1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.c2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c2</span></span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.c2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.c3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c3</span></span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.c3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.c4">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c4</span></span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.c4" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dot_product_test_derivatives">
<span class="sig-name descname"><span class="pre">dot_product_test_derivatives</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dot_product_test_derivatives" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dt_computation">
<span class="sig-name descname"><span class="pre">dt_computation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dt_computation" title="Permalink to this definition"></a></dt>
<dd><p>ref: Bai et al, 2013</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dxm">
<span class="sig-name descname"><span class="pre">dxm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dxm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dxp">
<span class="sig-name descname"><span class="pre">dxp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dxp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dzm">
<span class="sig-name descname"><span class="pre">dzm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dzm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.dzp">
<span class="sig-name descname"><span class="pre">dzp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.dzp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.fdm.order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#PyFWI.fwi_tools.fdm.order" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.grad_lmd_to_vd">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">grad_lmd_to_vd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">glam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.grad_lmd_to_vd" title="Permalink to this definition"></a></dt>
<dd><p>grad_lmr_to_vd switch the gradient.</p>
<p>This function witch the gradient from (lambda, mu, rho)
to (vp, vs, rho).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glam</strong> (<em>ndarray</em>) – Gradient w.r.t. lambda</p></li>
<li><p><strong>gmu</strong> (<em>ndarray</em>) – Gradient w.r.t. mu</p></li>
<li><p><strong>grho</strong> (<em>ndarray</em>) – Gradient w.r.t. density</p></li>
<li><p><strong>lam</strong> (<em>ndarray</em>) – Gradient w.r.t. lambda</p></li>
<li><p><strong>mu</strong> (<em>ndarray</em>) – Gradient w.r.t. mu</p></li>
<li><p><strong>rho</strong> (<em>ndarray</em>) – Gradient w.r.t. density</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Refrences:</dt><dd><ol class="arabic simple">
<li><p>Hu et al, 2021, Direct updating of rock-physics properties using elastice full-waveform inversion</p></li>
<li><p>Zhou and Lumely, 2021, Central-difference time-lapse 4D seismic full-waveform inversion</p></li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.grad_vd_to_lmd">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">grad_vd_to_lmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gvp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.grad_vd_to_lmd" title="Permalink to this definition"></a></dt>
<dd><p>grad_vd_to_lmd [summary]</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glam</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>gmu</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>grho</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>lam</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>mu</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rho</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Refrences:</dt><dd><ol class="arabic simple">
<li><p>Hu et al, 2021, Direct updating of rock-physics properties using elastice full-waveform inversion</p></li>
<li><p>Zhou and Lumely, 2021, Central-difference time-lapse 4D seismic full-waveform inversion</p></li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.inpa_generator">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">inpa_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.inpa_generator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.inpa_loading">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">inpa_loading</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.inpa_loading" title="Permalink to this definition"></a></dt>
<dd><p>inpa_loading lad the INPA file</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>input of FWI program</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>inpa (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.lowpass">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">lowpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.lowpass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.modeling_model">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">modeling_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.modeling_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.pcs_dict2vec">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">pcs_dict2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.pcs_dict2vec" title="Permalink to this definition"></a></dt>
<dd><p>pcs_dict2vec converts a dictionary of PCS to a vector</p>
<p>This function converts a dictionary of PCS to vector which is
used during the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m0</strong> (<em>dictionary</em>) – A dictionary ccontaining ‘phi’, ‘cc’, ‘sw’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector containg the whole parameters of the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>m (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.pml_counstruction">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">pml_counstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TNz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pml_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.pml_counstruction" title="Permalink to this definition"></a></dt>
<dd><p>PML construction generate two matrices for x- and z-directions with the
size of velocity model plus number of pml samples in each direction.</p>
<p>dx_pml and dz_pml are obtained based on Gao et al., 2017, Comparison of
artiﬁcial absorbing boundaries for acoustic wave equation modelling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TNz</strong> (<em>int</em>) – Number of samples in z-direction (<cite>n_z + 2 * n_pml</cite>).</p></li>
<li><p><strong>TNx</strong> (<em>int</em>) – Number of samples in x-direction (<cite>n_x + 2 * n_pml</cite>).</p></li>
<li><p><strong>dh</strong> (<em>float</em>) – Spatial ampling rate in x-direction.</p></li>
<li><p><strong>n_pml</strong> (<em>int</em><em>, </em><em>optional = 10</em>) – Number of pml layer</p></li>
<li><p><strong>pml_r</strong> (<em>float</em><em>, </em><em>optional = 1e-5</em>) – Theoretical reﬂection coefﬁcient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dx_pml</strong> (<em>float</em>) – A matrix with the size of [TNz, TNx] with zero value
everywhere excpete inside PML in right and left of model.</p></li>
<li><p><strong>dz_pml</strong> (<em>float</em>) –     A matrix with the size of [TNz, TNx] with zero value
everywhere excpet inside PML in above and bottom of model.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Gao et al., 2017, Comparison of artiﬁcial absorbing boundaries
for acoustic wave equation modelling, Exploration Geophysics,
2017, 48, 76–93.</p>
<p>[2] Araujo and Pestana, 2020, Perfectly matched layer boundary conditions
for the second-order acoustic wave equation solved by the rapid
expansion method, Geophysical Prospecting, 2020, 68, 572–590.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.pml_delta_calculation">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">pml_delta_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_pml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pml_r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.pml_delta_calculation" title="Permalink to this definition"></a></dt>
<dd><p>This function generates delta vector for PML construction function which put this vector
around the model matrices.</p>
<p>dx_pml and dz_pml are obtained based on Gao et al., 2017, Comparison of
artiﬁcial absorbing boundaries for acoustic wave equation modelling.</p>
<dl class="field-list simple">
<dt class="field-odd">Warns</dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>I have to add dz as well</em>)</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>dh</strong> (<em>float</em>) – Sampling rate in x-direction.</p></li>
<li><p><strong>n_pml</strong> (<em>int</em><em>, </em><em>optional = 10</em>) – Number of pml layers</p></li>
<li><p><strong>pml_r</strong> (<em>float</em><em>, </em><em>optional = 1e-5</em>) – Theoretical reﬂection coefﬁcient.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>delta</strong> – A vector containing the absorbant value for putting in absorbant
layer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Gao et al., 2017, Comparison of artiﬁcial absorbing boundaries
for acoustic wave equation modelling, Exploration Geophysics,
2017, 48, 76–93.</p>
<p>[2] Araujo and Pestana, 2020, Perfectly matched layer boundary conditions
for the second-order acoustic wave equation solved by the rapid
expansion method, Geophysical Prospecting, 2020, 68, 572–590.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.recorder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">recorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.recorder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.recorder.acquire">
<span class="sig-name descname"><span class="pre">acquire</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.recorder.acquire" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">regularization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.cost_regularization">
<span class="sig-name descname"><span class="pre">cost_regularization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tv_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tikhonov_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tikhonov0_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.cost_regularization" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.l1">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.l1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.l2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">l2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.l2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.tikhonov">
<span class="sig-name descname"><span class="pre">tikhonov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.tikhonov" title="Permalink to this definition"></a></dt>
<dd><p>A method to implement Tikhonov regularization with order of 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>1D ndarray</em>) – Data</p></li>
<li><p><strong>alpha_z</strong> (<em>float</em>) – coefficient of Dz</p></li>
<li><p><strong>alpha_x</strong> (<em>float</em>) – coefficient of Dx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rms</strong> (<em>float</em>) – error</p></li>
<li><p><strong>grad</strong> (<em>1D ndarray</em>) – gradient of the regularization</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.tikhonov_0">
<span class="sig-name descname"><span class="pre">tikhonov_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.tikhonov_0" title="Permalink to this definition"></a></dt>
<dd><p>A method to implement Tikhonov regularization with order of 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>1D ndarray</em>) – Data</p></li>
<li><p><strong>alpha_z</strong> (<em>float</em>) – coefficient of Dz</p></li>
<li><p><strong>alpha_x</strong> (<em>float</em>) – coefficient of Dx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rms</strong> (<em>float</em>) – error</p></li>
<li><p><strong>grad</strong> (<em>1D ndarray</em>) – gradient of the regularization</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.regularization.tv">
<span class="sig-name descname"><span class="pre">tv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.regularization.tv" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Inputs:</dt><dd><p>x: Data
eps: small value for make it deffrintiable at zero
az: coefficient of Dz
ax: coefficient of Dx
nz:</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.residual">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.residual" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.source_weighting">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">source_weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_pre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.source_weighting" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.svd_reconstruction">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">svd_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begining_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_components</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.svd_reconstruction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.vec2pcs_dict">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">vec2pcs_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.vec2pcs_dict" title="Permalink to this definition"></a></dt>
<dd><p>vec2pcs_dict converts a vector of PCS to dictionary</p>
<p>This function converts a vector of PCS to dictionary which is
used during the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m0</strong> (<em>1-d ndarray</em>) – a vector containg the whole parameters of the model</p></li>
<li><p><strong>nz</strong> (<em>[</em><em>type</em><em>]</em>) – Number of samples of the model in z-direction</p></li>
<li><p><strong>nx</strong> (<em>[</em><em>type</em><em>]</em>) – Number of samples of the model in x-direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary ccontaining ‘phi’, ‘cc’, ‘sw’.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>m (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.vec2vel_dict">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">vec2vel_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.vec2vel_dict" title="Permalink to this definition"></a></dt>
<dd><p>vec2vel_dict converts a vector of DV to dictionary</p>
<p>This function converts a vector of DV to dictionary which is
used during the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m0</strong> (<em>1-d ndarray</em>) – a vector containg the whole parameters of the model</p></li>
<li><p><strong>nz</strong> (<em>[</em><em>type</em><em>]</em>) – Number of samples of the model in z-direction</p></li>
<li><p><strong>nx</strong> (<em>[</em><em>type</em><em>]</em>) – Number of samples of the model in x-direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary ccontaining ‘vp’, ‘vs’, ‘rho’.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>m (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.fwi_tools.vel_dict2vec">
<span class="sig-prename descclassname"><span class="pre">PyFWI.fwi_tools.</span></span><span class="sig-name descname"><span class="pre">vel_dict2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.fwi_tools.vel_dict2vec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-PyFWI.model_dataset">
<span id="model-dataset"></span><h2>model_dataset<a class="headerlink" href="#module-PyFWI.model_dataset" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Circular">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">Circular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Circular" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Circular.Hu_circles">
<span class="sig-name descname"><span class="pre">Hu_circles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Circular.Hu_circles" title="Permalink to this definition"></a></dt>
<dd><p>Hu_circles a model including porosity, clay content, and saturation.</p>
<p>This method creates a model including porosity, clay content, and saturation.
It is used in a paper published in 2021 in Geophysics by Qi Qu and his collegues.
If you use non-default values, new model with the same structure and new values will be generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing the density of quartz, clay, water, and hydrocarbon. Defaults to None.</p></li>
<li><p><strong>prop_back</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing background properties (porosity, clay content, and saturation). Defaults to None.</p></li>
<li><p><strong>prop_circle</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing properties in the circles (porosity, clay content, and saturation). Defaults to None.</p></li>
<li><p><strong>nz</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of saples in z-direction (rows). Defaults to 100.</p></li>
<li><p><strong>nx</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of saples in x-direction (column). Defaults to 100.</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Radius of the circles. Defaults to 8.</p></li>
<li><p><strong>monitor</strong> (<em>bool</em><em>, </em><em>optional</em>) – Specify if you are looking for monitor model. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the created model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (dictionary)</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p>Hu, Q., S. Keating, K. A. Innanen, and H. Chen, 2021,
Direct updating of rock-physics properties using elastic full-waveform inversion: Geophysics, 86, 3, MR117-MR132, doi: 10.1190/GEO2020-0199.1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Circular.louboutin">
<span class="sig-name descname"><span class="pre">louboutin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Circular.louboutin" title="Permalink to this definition"></a></dt>
<dd><p>louboutin Generate perturbation model based on only vp.</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[description]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Circular.perturbation_dv">
<span class="sig-name descname"><span class="pre">perturbation_dv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Circular.perturbation_dv" title="Permalink to this definition"></a></dt>
<dd><p>perturbation_dv creates perturbation model in different locations</p>
<p>perturbation_dv creates perturbation model in different locations
based on vp, vs, density</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[description]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Circular.yang">
<span class="sig-name descname"><span class="pre">yang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Circular.yang" title="Permalink to this definition"></a></dt>
<dd><p>Yang et al., 2018 for Truncated Newton method.</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[description]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[type]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Laminar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">Laminar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Laminar" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Laminar.Hu_laminar">
<span class="sig-name descname"><span class="pre">Hu_laminar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Laminar.Hu_laminar" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.Laminar.dupuy">
<span class="sig-name descname"><span class="pre">dupuy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.Laminar.dupuy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.model_dataset.ModelGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">ModelGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.ModelGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#PyFWI.model_dataset.Circular" title="PyFWI.model_dataset.Circular"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.model_dataset.Circular</span></code></a>, <a class="reference internal" href="#PyFWI.model_dataset.Laminar" title="PyFWI.model_dataset.Laminar"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.model_dataset.Laminar</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.ModelGenerator.marmousi">
<span class="sig-name descname"><span class="pre">marmousi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vintage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.ModelGenerator.marmousi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.model_dataset.ModelGenerator.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['vp']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.ModelGenerator.show" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.add_anomaly">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">add_anomaly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'circle'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.add_anomaly" title="Permalink to this definition"></a></dt>
<dd><p>add_anomaly adds anomaly to the previously created model.</p>
<p>This mathod add an anomally to the Earth mode that is already createad.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>float</em>) – The previously created model.</p></li>
<li><p><strong>anomaly</strong> (<em>float</em>) – The properties of the anomaly</p></li>
<li><p><strong>x</strong> (<em>[</em><em>type</em><em>]</em>) – x-location of the anomaly</p></li>
<li><p><strong>z</strong> (<em>[</em><em>type</em><em>]</em>) – z-location of the anomaly</p></li>
<li><p><strong>width</strong> (<em>[</em><em>type</em><em>]</em>) – Width of the anomaly</p></li>
<li><p><strong>height</strong> (<em>[</em><em>type</em><em>]</em>) – Height of the anomaly</p></li>
<li><p><strong>type</strong> (<em>str</em><em>, </em><em>optional</em>) – The shape of the anomaly. Defaults to “circle”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The new model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.add_circle">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">add_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circle_prop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.add_circle" title="Permalink to this definition"></a></dt>
<dd><p>add_circle adds a circle to the model</p>
<p>This function generates a circle in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>float</em>) – Already created model.</p></li>
<li><p><strong>circle_prop</strong> (<em>float</em>) – Property of the circle.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Radius of the circle</p></li>
<li><p><strong>cx</strong> (<em>int</em>) – x_location of the center</p></li>
<li><p><strong>cz</strong> (<em>int</em>) – z-location of the center</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.add_layer">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.add_layer" title="Permalink to this definition"></a></dt>
<dd><p>add_layer add alyer to the model</p>
<p>This function add a layer to the mdoel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>dict</em>) – Already created model.</p></li>
<li><p><strong>property</strong> (<em>dict</em>) – Property of the new layer</p></li>
<li><p><strong>lt</strong> (<em>array</em><em>, </em><em>int</em>) – Sample number ([x ,z]) of the top of the layer in the most left part</p></li>
<li><p><strong>lb</strong> (<em>array</em><em>, </em><em>int</em>) – Sample number ([x ,z]) of the bottom of the layer in the most left part</p></li>
<li><p><strong>rt</strong> (<em>array</em><em>, </em><em>int</em>) – Sample number ([x ,z]) of the top of the layer in the most right part</p></li>
<li><p><strong>rb</strong> (<em>array</em><em>, </em><em>int</em>) – Sample number ([x ,z]) of the bottom of the layer in the most right part</p></li>
<li><p><strong>#TODO</strong> – to develop for dipping layers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.background">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.background" title="Permalink to this definition"></a></dt>
<dd><p>add_layer genearte a layer of property.</p>
<p>This method generates one layer with property “bp”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bp</strong> (<em>dict</em>) – Background property</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.model_resizing">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">model_resizing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.model_resizing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.model_smoother">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">model_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.model_smoother" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.model_dataset.pcs_perturbation">
<span class="sig-prename descclassname"><span class="pre">PyFWI.model_dataset.</span></span><span class="sig-name descname"><span class="pre">pcs_perturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_circle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.model_dataset.pcs_perturbation" title="Permalink to this definition"></a></dt>
<dd><p>pcs_perturbation a model including porosity, clay content, and saturation.</p>
<p>This function creates a model including porosity, clay content, and saturation.
It is used in a paper published in 2021 in Geophysics by Qi Qu and his collegues.
If you use non-default values, new model with the same structure and new values will be generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing the density of quartz, clay, water, and hydrocarbon. Defaults to None.</p></li>
<li><p><strong>prop_back</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing background properties (porosity, clay content, and saturation). Defaults to None.</p></li>
<li><p><strong>prop_circle</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – A dictionary containing properties in the circles (porosity, clay content, and saturation). Defaults to None.</p></li>
<li><p><strong>nz</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of saples in z-direction (rows). Defaults to 100.</p></li>
<li><p><strong>nx</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of saples in x-direction (column). Defaults to 100.</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Radius of the circles. Defaults to 8.</p></li>
<li><p><strong>monitor</strong> (<em>bool</em><em>, </em><em>optional</em>) – Specify if you are looking for monitor model. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the created model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (dictionary)</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p>Hu, Q., S. Keating, K. A. Innanen, and H. Chen, 2021,
Direct updating of rock-physics properties using elastic full-waveform inversion: Geophysics, 86, 3, MR117-MR132, doi: 10.1190/GEO2020-0199.1.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-PyFWI.optimization">
<span id="optimization"></span><h2>optimization<a class="headerlink" href="#module-PyFWI.optimization" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.optimization.</span></span><span class="sig-name descname"><span class="pre">FWI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_well_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#PyFWI.wave_propagation.wave_propagator" title="PyFWI.wave_propagation.wave_propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.wave_propagation.wave_propagator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.fprime">
<span class="sig-name descname"><span class="pre">fprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.fprime" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.fprime_single">
<span class="sig-name descname"><span class="pre">fprime_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.fprime_single" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.gauss_newton">
<span class="sig-name descname"><span class="pre">gauss_newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.gauss_newton" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.parameter_optimization">
<span class="sig-name descname"><span class="pre">parameter_optimization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.parameter_optimization" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.optimization.FWI.steepest_descent">
<span class="sig-name descname"><span class="pre">steepest_descent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.FWI.steepest_descent" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.optimization.linesearch">
<span class="sig-prename descclassname"><span class="pre">PyFWI.optimization.</span></span><span class="sig-name descname"><span class="pre">linesearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fval_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">inf,</span> <span class="pre">inf]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.linesearch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.optimization.truncated">
<span class="sig-prename descclassname"><span class="pre">PyFWI.optimization.</span></span><span class="sig-name descname"><span class="pre">truncated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FO_waves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.optimization.truncated" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-PyFWI.processing">
<span id="processing"></span><h2>processing<a class="headerlink" href="#module-PyFWI.processing" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.processing.Gain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.processing.</span></span><span class="sig-name descname"><span class="pre">Gain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.processing.Gain" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="PyFWI.processing.Gain.test">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test</span></span><a class="headerlink" href="#PyFWI.processing.Gain.test" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.processing.Gain.time_linear">
<span class="sig-name descname"><span class="pre">time_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.processing.Gain.time_linear" title="Permalink to this definition"></a></dt>
<dd><p>time_linear generates a linear gain function related to time</p>
<p>This function generates a linear gain function with time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>show_gain</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we need to plot the gain function. Defaults to False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A class for applying the processing method.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GF (class)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.processing.Gain_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.processing.</span></span><span class="sig-name descname"><span class="pre">Gain_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.processing.Gain_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#PyFWI.processing.Gain" title="PyFWI.processing.Gain"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.processing.Gain</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.processing.Gain_function.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.processing.Gain_function.apply" title="Permalink to this definition"></a></dt>
<dd><p>apply applies the gain function on the data</p>
<p>apply applies the made gain on the data. It can show the original and gained data as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em>) – A list containing the seismic datafor different component</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – The option to let user to ask to show the seismic sections before and after gain. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gained data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gained_data [list]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyFWI.rock_physics">
<span id="rock-physics"></span><h2>rock_physics<a class="headerlink" href="#module-PyFWI.rock_physics" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">Density</span></span><a class="headerlink" href="#PyFWI.rock_physics.Density" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density.effective_density">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">effective_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Density.effective_density" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density.fluid">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fluid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_hydro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Density.fluid" title="Permalink to this definition"></a></dt>
<dd><p>fluid [summary]</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_hydro</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rho_w</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>sw</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Density of fluid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rho_f [type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density.gardner">
<span class="sig-name descname"><span class="pre">gardner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metric'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Density.gardner" title="Permalink to this definition"></a></dt>
<dd><p>gardner method to estimate the density</p>
<p>This mdethod estimate density of a model based on P-wave velocity. It
uses the Gardner’s eqution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>float</em>) – P-wave velocity</p></li>
<li><p><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – Specify the system of the units fo measurements (Metric or Imperial) . Defaults to “metric”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rho</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density.matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho_clay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_q</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Density.matrix" title="Permalink to this definition"></a></dt>
<dd><p>matrix [summary]</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho_clay</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>cc</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rho_q</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rho_m</strong> – Density of matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Density.rho_from_pcs">
<span class="sig-name descname"><span class="pre">rho_from_pcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Density.rho_from_pcs" title="Permalink to this definition"></a></dt>
<dd><p>This function calculate density from Porosity, clay content, and water Saturation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho_c</strong> – Density of clay</p></li>
<li><p><strong>rho_q</strong> – Density of quartz</p></li>
<li><p><strong>rho_w</strong> – Density of water</p></li>
<li><p><strong>rho_g</strong> – Density of gas</p></li>
<li><p><strong>cc</strong> – clay content</p></li>
<li><p><strong>sw</strong> – water saturation</p></li>
<li><p><strong>phi</strong> – Porosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rho</strong> – Effective density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Han">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">Han</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Han" title="Permalink to this definition"></a></dt>
<dd><p>Han estimates velocity based on porosity and clasy content</p>
<p>Han found empirical regressions relating ultrasonic (laboratory) velocities to porosity and clay content</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>[</em><em>type</em><em>]</em>) – [porosity</p></li>
<li><p><strong>cc</strong> (<em>[</em><em>type</em><em>]</em>) – clay content</p></li>
<li><p><strong>a1</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vp. Defaults to 5.77.</p></li>
<li><p><strong>a2</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vp. Defaults to 6.94.</p></li>
<li><p><strong>a3</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vp. Defaults to 1.728.</p></li>
<li><p><strong>b1</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vs. Defaults to 5.77.</p></li>
<li><p><strong>b2</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vs. Defaults to 6.94.</p></li>
<li><p><strong>b3</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for Vs. Defaults to 1.728.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>P-wave velocity (km/s)
vs = S-wave velocity (km/s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vp</p>
</dd>
</dl>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Hu et al, 2021, Direct updating of rock-physics properties using elastice full-waveform inversion</p></li>
<li><p>Mavko, G., Mukerji, T., &amp; Dvorkin, J., 2020, The rock physics handbook. Cambridge university press.</p></li>
</ol>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Lamb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">Lamb</span></span><a class="headerlink" href="#PyFWI.rock_physics.Lamb" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Lamb.vp_rho_mu">
<span class="sig-name descname"><span class="pre">vp_rho_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Lamb.vp_rho_mu" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Mu">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">Mu</span></span><a class="headerlink" href="#PyFWI.rock_physics.Mu" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.Mu.vs_rho">
<span class="sig-name descname"><span class="pre">vs_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.Mu.vs_rho" title="Permalink to this definition"></a></dt>
<dd><p>vs_rho generate mu</p>
<p>This function add mu to to the imported model based on S-wave velocity and density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vs</strong> (<em>float</em><em> or </em><em>dict</em>) – S-wave velocity. if dict, it has to contain value for density.</p></li>
<li><p><strong>rho</strong> (<em>float</em><em>, </em><em>option</em>) – Density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shear modulus</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mu</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.rock_physics.ShearVelocity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">ShearVelocity</span></span><a class="headerlink" href="#PyFWI.rock_physics.ShearVelocity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.ShearVelocity.Han">
<span class="sig-name descname"><span class="pre">Han</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.ShearVelocity.Han" title="Permalink to this definition"></a></dt>
<dd><p>Han calulates vs based on Han empirical model.</p>
<p>Han calulates vs based on Han empirical model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>[</em><em>type</em><em>]</em>) – Porosity</p></li>
<li><p><strong>cc</strong> (<em>[</em><em>type</em><em>]</em>) – Clay content</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>S-wave velocity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vp</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.ShearVelocity.poisson_ratio_vs">
<span class="sig-name descname"><span class="pre">poisson_ratio_vs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.ShearVelocity.poisson_ratio_vs" title="Permalink to this definition"></a></dt>
<dd><p>poisson_ratio_vs calculates the shear velocity.</p>
<p>Calculates the shear velocity based on Poisson’s ration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>float</em>) – P-wave velocity.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Poisson’s ration. It could be None if parameter “model” has this property. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The input model and shear velocity is added.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.biot_gassmann">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">biot_gassmann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.biot_gassmann" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.delta_biot_gassmann">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">delta_biot_gassmann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.delta_biot_gassmann" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.drained_moduli">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">drained_moduli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.drained_moduli" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.error_lack_of_data">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">error_lack_of_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.error_lack_of_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.lmd2vd">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">lmd2vd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.lmd2vd" title="Permalink to this definition"></a></dt>
<dd><p>lmd2vd switches Lama modulus and density to vp, vs, density</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>mu</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rho</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.rock_physics.p_velocity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">p_velocity</span></span><a class="headerlink" href="#PyFWI.rock_physics.p_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.p_velocity.Han">
<span class="sig-name descname"><span class="pre">Han</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.p_velocity.Han" title="Permalink to this definition"></a></dt>
<dd><p>Han calulates vp based on Han empirical model.</p>
<p>Han calulates vp based on Han empirical model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>[</em><em>type</em><em>]</em>) – Porosity</p></li>
<li><p><strong>cc</strong> (<em>[</em><em>type</em><em>]</em>) – Clay content</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>P-wave velocity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vp</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.p_velocity.gardner">
<span class="sig-name descname"><span class="pre">gardner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metric'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.p_velocity.gardner" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.rock_physics.p_velocity.lam_mu_rho">
<span class="sig-name descname"><span class="pre">lam_mu_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.p_velocity.lam_mu_rho" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.reverse_Han">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">reverse_Han</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.reverse_Han" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.vd2lmd">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">vd2lmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.vd2lmd" title="Permalink to this definition"></a></dt>
<dd><p>vd2lmd switches vp, vs, density to Lame modulus and density to</p>
<p>[extended_summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>vs</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>rho</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.rock_physics.voigt_berie">
<span class="sig-prename descclassname"><span class="pre">PyFWI.rock_physics.</span></span><span class="sig-name descname"><span class="pre">voigt_berie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.rock_physics.voigt_berie" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-PyFWI.seiplot">
<span id="seiplot"></span><h2>seiplot<a class="headerlink" href="#module-PyFWI.seiplot" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seiplot.earth_model">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seiplot.</span></span><span class="sig-name descname"><span class="pre">earth_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seiplot.earth_model" title="Permalink to this definition"></a></dt>
<dd><p>earth_model show the earth model.</p>
<p>This function is provided to show the earth models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Dictionary</em>) – A dictionary containing the earth model.</p></li>
<li><p><strong>keys</strong> (<em>list</em><em>, </em><em>optional</em>) – List of parameters you want to show. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The figure class  to which the images are added for furthur settings like im.set-clim().</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig (class)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seiplot.gn_plot">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seiplot.</span></span><span class="sig-name descname"><span class="pre">gn_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seiplot.gn_plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seiplot.inversion_video">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seiplot.</span></span><span class="sig-name descname"><span class="pre">inversion_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pause</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seiplot.inversion_video" title="Permalink to this definition"></a></dt>
<dd><p>inversion_video show the procedure of updating the model during the FWI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_video</strong> (<em>[</em><em>type</em><em>]</em>) – Matrix of model after each iteration</p></li>
<li><p><strong>pause</strong> (<em>float</em><em>, </em><em>optional</em>) – Lenght of pause between each model. Defaults to 0.2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seiplot.seismic_section">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seiplot.</span></span><span class="sig-name descname"><span class="pre">seismic_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_preserving</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seiplot.seismic_section" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-PyFWI.seismic_io">
<span id="seismic-io"></span><h2>seismic_io<a class="headerlink" href="#module-PyFWI.seismic_io" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seismic_io.load_mat">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seismic_io.</span></span><span class="sig-name descname"><span class="pre">load_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seismic_io.load_mat" title="Permalink to this definition"></a></dt>
<dd><p>This function load python dictionary as a .mat file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>String</em>) – The path to save the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seismic_io.load_pkl">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seismic_io.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seismic_io.load_pkl" title="Permalink to this definition"></a></dt>
<dd><p>load_pkl loads pkl file.</p>
<p>load_pkl loads pkl file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>string</em>) – Path of file to be loaded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Loaded file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seismic_io.read_segy">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seismic_io.</span></span><span class="sig-name descname"><span class="pre">read_segy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seismic_io.read_segy" title="Permalink to this definition"></a></dt>
<dd><p>A function to load segy file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – The path of segy file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The data stored in segy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seismic_io.save_mat">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seismic_io.</span></span><span class="sig-name descname"><span class="pre">save_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seismic_io.save_mat" title="Permalink to this definition"></a></dt>
<dd><p>This function save python dictionary as a .mat file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>String</em>) – The path to save the data.</p></li>
<li><p><strong>unique</strong> (<em>Boolean</em>) – If true, it will add current date and time to the name of folder</p></li>
<li><p><strong>**kwargs</strong> (<em>type</em>) – Dictionaries containing the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyFWI.seismic_io.save_pkl">
<span class="sig-prename descclassname"><span class="pre">PyFWI.seismic_io.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.seismic_io.save_pkl" title="Permalink to this definition"></a></dt>
<dd><p>save_pkl saves pkl file.</p>
<p>save_pkl saves file with pkl format. That is better than .mat file
for preserving the structure of dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>string</em>) – path to save the file(s).</p></li>
<li><p><strong>**kwargs</strong> (<em>data</em>) – Variable(s) to be saved.</p></li>
<li><p><strong>the</strong> (<em>A boolean argument with name of &quot;unique&quot; can be given to make</em>) – </p></li>
<li><p><strong>data.</strong> (<em>path based on the</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-PyFWI.wave_propagation">
<span id="wave-propagation"></span><h2>wave_propagation<a class="headerlink" href="#module-PyFWI.wave_propagation" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.wave_propagation.</span></span><span class="sig-name descname"><span class="pre">wave_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inpa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_well_rec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.adjoint_buffer_preparing">
<span class="sig-name descname"><span class="pre">adjoint_buffer_preparing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.adjoint_buffer_preparing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.elastic_buffers">
<span class="sig-name descname"><span class="pre">elastic_buffers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.elastic_buffers" title="Permalink to this definition"></a></dt>
<dd><p>Model hast contain vp, vs, and rho</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.gradient_reading">
<span class="sig-name descname"><span class="pre">gradient_reading</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.gradient_reading" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.initial_wavefield_plot">
<span class="sig-name descname"><span class="pre">initial_wavefield_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Forward'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.initial_wavefield_plot" title="Permalink to this definition"></a></dt>
<dd><p>A function to initialize the the plot for wave
propagation visulizing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>plot_type</strong> (<em>string optional = &quot;Forward&quot;</em>) – Specify if we want to show Forward modelloing or Backward.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.kernel_caller">
<span class="sig-name descname"><span class="pre">kernel_caller</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.kernel_caller" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to specify the constants for use in openCl’s
files and choose the asked openCl source to run based on the assumptions
of problem.</p>
<p>The coeeficients are based on Lavendar, 1988 and Hasym et al., 2014.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>kernel_source</strong> – macro plus the openCl’s source.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.make_residual">
<span class="sig-name descname"><span class="pre">make_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.make_residual" title="Permalink to this definition"></a></dt>
<dd><p>This function reads the inject the residual to residual buffer based on source and the
time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>list</em>) – list containing the residual of all parameters</p></li>
<li><p><strong>s</strong> (<em>int</em>) – Number of current acive source.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.make_seismogram">
<span class="sig-name descname"><span class="pre">make_seismogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.make_seismogram" title="Permalink to this definition"></a></dt>
<dd><p>This function read the seismogram buffer and put its value in the
right place in main seismogram matrix based on source and the
time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>int</em>) – Number of current acive source.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.plot_propagation">
<span class="sig-name descname"><span class="pre">plot_propagation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.plot_propagation" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to shpw the propagation wave with time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave1</strong> (<em>float32</em>) – The wave that we are going to show</p></li>
<li><p><strong>t</strong> (<em>float32</em>) – Time step</p></li>
<li><p><strong>wave2</strong> (<em>flaot32</em><em>, </em><em>optional = None</em>) – The second wave which is used when we want to show the propagation
of backward wave as wave1 and adjoint wave as wave2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_preparation.pml_preparation">
<span class="sig-name descname"><span class="pre">pml_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_preparation.pml_preparation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_propagator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyFWI.wave_propagation.</span></span><span class="sig-name descname"><span class="pre">wave_propagator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inpa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rec_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_well_rec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_propagator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#PyFWI.wave_propagation.wave_preparation" title="PyFWI.wave_propagation.wave_preparation"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFWI.wave_propagation.wave_preparation</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_propagator.forward_modeling">
<span class="sig-name descname"><span class="pre">forward_modeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_propagator.forward_modeling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_propagator.forward_propagator">
<span class="sig-name descname"><span class="pre">forward_propagator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_propagator.forward_propagator" title="Permalink to this definition"></a></dt>
<dd><p>This function is in charge of forward modelling for acoustic case</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>dictionary</em>) – A dictionary containing p-wave velocity and density</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyFWI.wave_propagation.wave_propagator.gradient">
<span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PyFWI.wave_propagation.wave_propagator.gradient" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-PyFWI">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-PyFWI" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Amir Mardan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>